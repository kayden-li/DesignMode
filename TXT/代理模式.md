# 代理模式

1. 为一个对象提供一个替身，可以在目标实现的基础上，增强额外的功能操作
2. 代理对象：远程对象、创建开销大的对象或需要安全控制的对象
3. 代理模式：静态代理、动态代理（JDK代理、接口代理）和Cglib代理（在内存中动态创建对象，而不需要实现接口。属于动态代理部分）

***

### 静态代理

使用时需要定义接口或父类，被代理对象与代理对象一起实现相同的接口或继承相同的父类

1. 在不修改目标对象的功能前提下，能通过代理对象对目标功能进行扩展
2. 代理对象需要与目标对象实现相同接口，所以会有很多代理类
3. 一旦增加方法，目标对象与代理对象都需要维护

***

### 动态代理（JDK代理、接口代理）

**java.lang.reflect.Proxy**

1. 代理对象不实现接口，目标对象要 **实现接口**
2. 代理对象的生成是利用JDK的API，动态的在内存中构建对象

***

### Cglib代理（子类代理）

1. 目标对象可以 **不实现任何接口**
2. 有时将Cglib代理归属到动态代理
3. Cglib是一个高性能的代码生成包，被许多AOP框架使用，如Spring AOP实现方法拦截
4. Cglib底层是通过使用字节码处理框架ASM来转换字节码并生成新的类

*   代理类不能为final
*   目标对象的方法如果为final/static，就不会被拦截，不会执行目标对象额外的业务方法

***

### 代理模式变体

1. 防火墙代理：内网通过代理穿透防火墙，实现对公网的访问
2. 缓存代理：如当请求图片文件等资源时，想到缓存代理取，若取不到资源再从公网或数据库中取，然后缓存
3. 远程代理： **远程对象的本地代表**，通过它把远程对象当本地对象来调用。远程代理通过网络和真正的远程对象沟通信息
4. 同步代理：主要使用在多线程编程中，完成多线程间的同步工作